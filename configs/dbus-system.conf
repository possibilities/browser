<!-- Custom system bus config for apple/container VMs.
     Based on the default system.conf but omits <user>messagebus</user>
     to avoid capability dropping which is not supported in the VM. -->
<!DOCTYPE busconfig PUBLIC "-//freedesktop//DTD D-Bus Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <type>custom</type>

  <!-- No <user> directive: run as whoever started the daemon (root). -->

  <listen>unix:path=/run/dbus/system_bus_socket</listen>

  <auth>EXTERNAL</auth>

  <standard_system_servicedirs/>

  <policy context="default">
    <allow user="*"/>
    <allow own="*"/>
    <allow send_type="method_call"/>
    <allow send_type="signal"/>
    <allow send_type="method_return"/>
    <allow send_type="error"/>
    <allow receive_type="method_call"/>
    <allow receive_type="method_return"/>
    <allow receive_type="error"/>
    <allow receive_type="signal"/>
    <allow send_destination="org.freedesktop.DBus"/>
  </policy>

  <includedir>/etc/dbus-1/system.d</includedir>
</busconfig>
